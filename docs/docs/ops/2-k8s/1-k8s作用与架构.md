# k8s 作用与架构

## Kubernetes的作用
- **容器编排**：Kubernetes提供了高级的容器管理功能，包括容器的部署、扩展、更新和维护。
- **服务发现和负载均衡**：Kubernetes能够自动分配负载并发现服务。
- **自我修复**：Kubernetes监控容器的健康状态，自动替换失败的容器实例。
- **水平扩展**：Kubernetes可以根据实时负载自动扩展容器实例的数量。
- **声明式部署**：用户通过声明期望的状态，Kubernetes自动将当前状态更改为期望状态。
- **配置管理**：Kubernetes允许集中管理应用的配置。
- **存储编排**：Kubernetes支持持久化存储和动态卷挂载。
- **多环境支持**：Kubernetes支持在不同的环境（开发、测试、生产）中运行相同的应用配置。
- **安全性**：Kubernetes提供了网络策略、服务账户、角色绑定等安全机制。
- **多租户支持**：Kubernetes支持多租户部署，允许多个团队或用户共享资源。
- **开发者和运维协作**：Kubernetes促进了开发和运维团队之间的协作。
- **云原生应用开发**：Kubernetes推动了云原生应用的开发，支持微服务架构和CI/CD流程。
- **生态系统和扩展性**：Kubernetes拥有丰富的生态系统，支持多种扩展和集成。


## 架构
![](https://img.ilovestudy.club/blog/architecture.jpg)

### Master 节点和Node节点    
- Kubernetes集群由Master节点和Node节点组成。
- Master 节点负责管理集群，Node节点负责运行容器。
- Master 节点也可以做为Node节点
- k8s集群至少一个Master和一个Node节点。

Master节点结构图：
- ![](http://img.ilovestudy.club/blog/kubernetes-.png)

Node节点结构图：
- ![](http://img.ilovestudy.club/blog/kubernetes-node.png)

| 节点            | 组件                 | 功能描述                        |
|---------------|--------------------|-----------------------------|
| **Master 节点** |                    | **负责集群的管理和控制。**             |
|               | API Server         | 所有对k8s集群的操作都要经过 API Server。 |          |
|               | Scheduler          | 根据资源需求等规则调度Pod到不同的Node上。    |
|               | Controller Manager | 运行集群中各种控制器。                 |
|               | etcd               | Kubernetes集群的后端存储。          |
| **Node 节点**   |                    | **负责运行集群中的工作负载。**           |
|               | Kubelet            | 在每个Node上运行，负责启动容器等。         |
|               | Kube-proxy         | 在每个Node上运行，负责实现服务发现和负载均衡。   |
|               | Container Runtime  | 负责容器的生命周期管理。                |


### Kubernetes 核心资源组件

| 资源名称       | 作用或备注说明                                          |
|----------------|--------------------------------------------------|
| Pod            | 运行容器化应用的最小部署单元。                                  |
| Service        | 东西流量(服务间横向访问),提供对一组 Pod 的访问策略，实现负载均衡和网络服务发现。     |
| Ingress        | 北向流量(集群外接的纵向访问)的路由网关定义，ingress-nginx 是它控制器的实现之一。 |
| Volume         | 为 Pod 提供存储卷，支持数据持久化。                             |
| Namespace      | 逻辑分区，用于隔离不同的用户或项目。                               |
| Deployment     | 管理 Pod 和 ReplicaSet 的声明式更新和自我修复。                 |
| StatefulSet    | 管理有状态应用的 Pod，提供顺序部署、扩展和缩容。                       |
| DaemonSet      | 通过标签选择器，在每个匹配的 Node 上自动运行一个 Pod 副本。              |
| CronJob        | 管理定时任务，类似于 UNIX 的 cron 工具。                       |
| ConfigMap      | 存储配置信息，供 Pod 挂载或注入环境变量。                          |
| Secret         | 存储敏感信息，如密码、OAuth 令牌和 SSH 密钥。                     |
| ReplicaSet     | 确保指定数量的 Pod 副本始终运行，用于Pod的水平扩展和替换。                              |
