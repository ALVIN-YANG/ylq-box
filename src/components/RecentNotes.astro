---
import { getCollection } from 'astro:content';
import { LinkCard, CardGrid } from '@astrojs/starlight/components';

const allDocs = await getCollection('docs');

const recentDocs = allDocs
  .filter(doc => {
    const id = doc.id;
    return id
      && !id.endsWith('index')
      && !id.includes('_category_')
      && id !== 'index.mdx'
      && !id.startsWith('guides/')
      && !id.startsWith('reference/');
  })
  .sort((a, b) => {
    const dateA = a.data.lastUpdated || a.data.date || new Date(0);
    const dateB = b.data.lastUpdated || b.data.date || new Date(0);
    return new Date(dateB).getTime() - new Date(dateA).getTime();
  })
  .slice(0, 6);
---

<CardGrid stagger>
  {recentDocs.map(doc => (
    <LinkCard
      title={doc.data.title}
      description={doc.data.description || ''}
      href={`/${doc.id.replace(/\.mdx?$/, '').replace(/\/index$/, '/')}/`}
    />
  ))}
</CardGrid>
